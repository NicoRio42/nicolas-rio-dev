---
import type { Locale } from "@models/locale";
import labels from "@content/_labels.json";
import { getCollection } from "astro:content";

export interface Props {
  locale: Locale;
}

const { locale } = Astro.props;

const allReferences = (await getCollection("references")).filter((experience) =>
  experience.slug.startsWith(locale)
);
---

<h2 flex items-center gap-2 font-heading text="6 primary" mt-8>
  <i i-carbon-star inline-block w-8 h-8></i>

  {labels.references.heading[locale]}
</h2>

{
  allReferences.map(async ({ data, render }, index) => {
    const { Content } = await render();

    return (
      <article
        flex="~ col sm:row"
        items-center
        gap-6
        class:list={{
          "sm:flex-row-reverse": index % 2 === 1,
        }}
        mt-8
      >
        <img
          {...data.image}
          alt={
            locale === "fr"
              ? `Photo de ${data.name}`
              : `Picture of ${data.name}`
          }
          shrink-0
          rounded-full
          w-36
          h-36
        />

        <div class="prose prose-zinc" grow-1>
          <div font-italic>
            <Content />
          </div>

          <p text="3.5">
            {data.name} | {data.role}
          </p>
        </div>
      </article>
    );
  })
}
